<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>sta_crm_accounts_bj</name>
    <description>ETL数据转换任务</description>
    <extended_description />
    <trans_version />
    <trans_type>Normal</trans_type>
    <trans_status>2</trans_status>
    <directory>/</directory>
    <parameters>
      <parameter>
        <name>op_time</name>
        <default_value>20170412</default_value>
        <description />
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection />
        <schema />
        <table>ETL_log</table>
        <size_limit_lines />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject />
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject />
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject />
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject />
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection />
        <schema />
        <table />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection />
        <schema />
        <table>log_etl</table>
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection />
      <table />
      <field />
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file />
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2017/08/08 17:44:23.045</created_date>
    <modified_user>-</modified_user>
    <modified_date>2017/08/09 14:49:51.650</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>conn_crm_bj</name>
    <server>${crm_bj_database_ip}</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>${crm_bj_database_name}</database>
    <port>${crm_bj_database_port}</port>
    <username>${crm_bj_username}</username>
    <password>${crm_bj_passwd}</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.zeroDateTimeBehavior</code>
        <attribute>convertToNull</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${crm_bj_database_port}</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>conn_edw</name>
    <server>${edw_database_ip}</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>${edw_database_name}</database>
    <port>${edw_database_port}</port>
    <username>${edw_username}</username>
    <password>${edw_passwd}</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.rewriteBatchedStatements</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCompression</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useServerPrepStmts</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>${edw_database_port}</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>crm.accounts</from>
      <to>sta_crm_accounts_bj</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>版本信息</from>
      <to>获取变量</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>获取变量</from>
      <to>crm.accounts</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>crm.accounts</name>
    <type>TableInput</type>
    <description />
    <distribute>N</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>conn_crm_bj</connection>
    <sql>SELECT
${op_time} as  op_time,
  id
, name
, date_entered
, date_modified
, modified_user_id
, assigned_user_id
, created_by
, description
, CAST(deleted AS CHAR) AS deleted  
, assigned_dept_id
, cast(readed_sign as char) as readed_sign 
, assigned_user_time
, first_name
, last_name
, cast(gender as char) as gender 
, company
, search_code
, phone_mobile1
, phone_mobile2
, phone_home1_code
, phone_home1
, phone_home1_no
, phone_home2_code
, phone_home2
, phone_home2_no
, phone_fax_code
, phone_fax
, phone_fax_no
, qq
, mail_address
, msn
, primary_address_street
, primary_address_city
, primary_address_zone
, primary_address_plot
, alt_address_street
, alt_address_city
, alt_address_zone
, alt_address_plot
, going
, birthdate
, idcardno
, credit_status
, credit_desc
, flowing_water
, industry
, area
, registration_time
, operation_time
, year_income
, profit_rate
, stock_value
, account_source1
, account_source2
, campaign_id
, parent_type
, parent_id
, account_value
, life_cycle
, date_cycle_start
, second_sales_possibility
, maintenance_policy
, cast(status as char) as status 
, recent_stranded_date
, first_call_datetime
, first_meeting_datetime
, last_call_datetime
, last_meeting_datetime
, next_call_datetime
, next_meeting_datetime
, next_contact_datetime
, total_call_count
, total_meeting_count
, final_contact_datetime
, info_deadline
, manager_deadline
, change_manager_deadline
, dept_deadline
, lifecycle_deadline
, cast( accountinfo_completeness_sign as char) as accountinfo_completeness_sign 
, cast(opptinfo_completeness_sign as char) as opptinfo_completeness_sign 
, number
, property_prove
, stranded_user_id
, initial_user_id
, initial_dept_id
, change_times
, main_number_field
, unicode_id
, is_private
, cast(cancel_sign as char) as cancel_sign 
, date_created
, activation_count
, boss_sign
, cti_last_callin_datetime
, cti_last_callout_datetime
, cti_contact_deadline
, cast(contact_policy as char) as contact_policy 
, cast(is_recovery as char) as is_recovery 
, cast(2013_3_sign as char) as 2013_3_sign 
, source_type
, assigned_dept_id_bak
, assigned_user_id_bak
, organize_id
, domainFrom
, cast(is_estate as char) as is_estate
, estate_num
, cast(is_estate_project as char) as is_estate_project 
, monthly_house_payments_date
, monthly_house_payments_amount
, cast(is_car as char) as is_car 
, car_num
, cast(is_car_mortgage as char) as is_car_mortgage
, monthly_car_payments_date
, monthly_car_payments_amount
, cast(is_car_full as char) as is_car_full 
, car_full_amaount
, by_car_date
, cast(is_business_entity as char) as is_business_entity
, business_entity_water
, cast(is_business_license as char) as is_business_license
, registration_date
, no_business_license_date
, cast(is_credit as char) as is_credit
, credit_total_amount
, credit_use_amount
, cast(is_social_security as char) as is_social_security 
, social_security_base
, social_security_hand
, cast(is_accumulation_fund as char) as is_accumulation_fund 
, accumulation_fund_base
, accumulation_fund_hand
, cast(is_policy as char) as is_policy
, year_month_pay
, policy_type
, policy_date
, policy_amount
, cast(is_history_project as char) as is_history_project 
, history_project
, cast(is_rejected_project as char) as is_rejected_project
, rejected_project_reason
,cast(is_know_project_spouse as char) as is_know_project_spouse 
, cast(is_know_project_colleague as char) as is_know_project_colleague
, cast(is_know_project_relative as char) as is_know_project_relative
, cast(is_know_project_friend as char) as is_know_project_friend
, credit_total_overdue
, credit_continuous_overdue
, income_amount
, cast(business_entity as char) as business_entity 
, flowing
, cast(nation as char) as nation
,cast(education as char) as education
,cast(wedlock as char) as wedlock 
, cast(income_source as char) as income_source
, cast(is_children as char) as is_children
, cast(is_verify as char) as is_verify
, verify_user_id
, verify_date
, profession
, purchase_channel1_id
, purchase_channel1_name
, purchase_channel2_id
, purchase_channel2_name
, purchase_type
, from_channels1_id
, from_channels1_name
, from_channels2_id
, from_channels2_name
, cast(create_type as char) as create_type 
, idcardno_address
FROM accounts
where
date_entered BETWEEN DATE_FORMAT('${op_time}','%Y%m%d') 
              AND DATE_FORMAT('${op_time}235959','%Y%m%d%H%i%S')
or
date_modified BETWEEN DATE_FORMAT('${op_time}','%Y%m%d') 
              AND DATE_FORMAT('${op_time}235959','%Y%m%d%H%i%S');

</sql>
    <limit>0</limit>
    <lookup>获取变量</lookup>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>432</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>sta_crm_accounts_bj</name>
    <type>TableOutput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>conn_edw</connection>
    <schema />
    <table>sta_crm_accounts_bj</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field />
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field />
    <fields>
      <field>
        <column_name>op_time</column_name>
        <stream_name>op_time</stream_name>
      </field>
      <field>
        <column_name>id</column_name>
        <stream_name>id</stream_name>
      </field>
      <field>
        <column_name>name</column_name>
        <stream_name>name</stream_name>
      </field>
      <field>
        <column_name>date_entered</column_name>
        <stream_name>date_entered</stream_name>
      </field>
      <field>
        <column_name>date_modified</column_name>
        <stream_name>date_modified</stream_name>
      </field>
      <field>
        <column_name>modified_user_id</column_name>
        <stream_name>modified_user_id</stream_name>
      </field>
      <field>
        <column_name>assigned_user_id</column_name>
        <stream_name>assigned_user_id</stream_name>
      </field>
      <field>
        <column_name>created_by</column_name>
        <stream_name>created_by</stream_name>
      </field>
      <field>
        <column_name>description</column_name>
        <stream_name>description</stream_name>
      </field>
      <field>
        <column_name>deleted</column_name>
        <stream_name>deleted</stream_name>
      </field>
      <field>
        <column_name>assigned_dept_id</column_name>
        <stream_name>assigned_dept_id</stream_name>
      </field>
      <field>
        <column_name>readed_sign</column_name>
        <stream_name>readed_sign</stream_name>
      </field>
      <field>
        <column_name>assigned_user_time</column_name>
        <stream_name>assigned_user_time</stream_name>
      </field>
      <field>
        <column_name>first_name</column_name>
        <stream_name>first_name</stream_name>
      </field>
      <field>
        <column_name>last_name</column_name>
        <stream_name>last_name</stream_name>
      </field>
      <field>
        <column_name>gender</column_name>
        <stream_name>gender</stream_name>
      </field>
      <field>
        <column_name>company</column_name>
        <stream_name>company</stream_name>
      </field>
      <field>
        <column_name>search_code</column_name>
        <stream_name>search_code</stream_name>
      </field>
      <field>
        <column_name>phone_mobile1</column_name>
        <stream_name>phone_mobile1</stream_name>
      </field>
      <field>
        <column_name>phone_mobile2</column_name>
        <stream_name>phone_mobile2</stream_name>
      </field>
      <field>
        <column_name>phone_home1_code</column_name>
        <stream_name>phone_home1_code</stream_name>
      </field>
      <field>
        <column_name>phone_home1</column_name>
        <stream_name>phone_home1</stream_name>
      </field>
      <field>
        <column_name>phone_home1_no</column_name>
        <stream_name>phone_home1_no</stream_name>
      </field>
      <field>
        <column_name>phone_home2_code</column_name>
        <stream_name>phone_home2_code</stream_name>
      </field>
      <field>
        <column_name>phone_home2</column_name>
        <stream_name>phone_home2</stream_name>
      </field>
      <field>
        <column_name>phone_home2_no</column_name>
        <stream_name>phone_home2_no</stream_name>
      </field>
      <field>
        <column_name>phone_fax_code</column_name>
        <stream_name>phone_fax_code</stream_name>
      </field>
      <field>
        <column_name>phone_fax</column_name>
        <stream_name>phone_fax</stream_name>
      </field>
      <field>
        <column_name>phone_fax_no</column_name>
        <stream_name>phone_fax_no</stream_name>
      </field>
      <field>
        <column_name>qq</column_name>
        <stream_name>qq</stream_name>
      </field>
      <field>
        <column_name>mail_address</column_name>
        <stream_name>mail_address</stream_name>
      </field>
      <field>
        <column_name>msn</column_name>
        <stream_name>msn</stream_name>
      </field>
      <field>
        <column_name>primary_address_street</column_name>
        <stream_name>primary_address_street</stream_name>
      </field>
      <field>
        <column_name>primary_address_city</column_name>
        <stream_name>primary_address_city</stream_name>
      </field>
      <field>
        <column_name>primary_address_zone</column_name>
        <stream_name>primary_address_zone</stream_name>
      </field>
      <field>
        <column_name>primary_address_plot</column_name>
        <stream_name>primary_address_plot</stream_name>
      </field>
      <field>
        <column_name>alt_address_street</column_name>
        <stream_name>alt_address_street</stream_name>
      </field>
      <field>
        <column_name>alt_address_city</column_name>
        <stream_name>alt_address_city</stream_name>
      </field>
      <field>
        <column_name>alt_address_zone</column_name>
        <stream_name>alt_address_zone</stream_name>
      </field>
      <field>
        <column_name>alt_address_plot</column_name>
        <stream_name>alt_address_plot</stream_name>
      </field>
      <field>
        <column_name>going</column_name>
        <stream_name>going</stream_name>
      </field>
      <field>
        <column_name>birthdate</column_name>
        <stream_name>birthdate</stream_name>
      </field>
      <field>
        <column_name>idcardno</column_name>
        <stream_name>idcardno</stream_name>
      </field>
      <field>
        <column_name>credit_status</column_name>
        <stream_name>credit_status</stream_name>
      </field>
      <field>
        <column_name>credit_desc</column_name>
        <stream_name>credit_desc</stream_name>
      </field>
      <field>
        <column_name>flowing_water</column_name>
        <stream_name>flowing_water</stream_name>
      </field>
      <field>
        <column_name>industry</column_name>
        <stream_name>industry</stream_name>
      </field>
      <field>
        <column_name>area</column_name>
        <stream_name>area</stream_name>
      </field>
      <field>
        <column_name>registration_time</column_name>
        <stream_name>registration_time</stream_name>
      </field>
      <field>
        <column_name>operation_time</column_name>
        <stream_name>operation_time</stream_name>
      </field>
      <field>
        <column_name>year_income</column_name>
        <stream_name>year_income</stream_name>
      </field>
      <field>
        <column_name>profit_rate</column_name>
        <stream_name>profit_rate</stream_name>
      </field>
      <field>
        <column_name>stock_value</column_name>
        <stream_name>stock_value</stream_name>
      </field>
      <field>
        <column_name>account_source1</column_name>
        <stream_name>account_source1</stream_name>
      </field>
      <field>
        <column_name>account_source2</column_name>
        <stream_name>account_source2</stream_name>
      </field>
      <field>
        <column_name>campaign_id</column_name>
        <stream_name>campaign_id</stream_name>
      </field>
      <field>
        <column_name>parent_type</column_name>
        <stream_name>parent_type</stream_name>
      </field>
      <field>
        <column_name>parent_id</column_name>
        <stream_name>parent_id</stream_name>
      </field>
      <field>
        <column_name>account_value</column_name>
        <stream_name>account_value</stream_name>
      </field>
      <field>
        <column_name>life_cycle</column_name>
        <stream_name>life_cycle</stream_name>
      </field>
      <field>
        <column_name>date_cycle_start</column_name>
        <stream_name>date_cycle_start</stream_name>
      </field>
      <field>
        <column_name>second_sales_possibility</column_name>
        <stream_name>second_sales_possibility</stream_name>
      </field>
      <field>
        <column_name>maintenance_policy</column_name>
        <stream_name>maintenance_policy</stream_name>
      </field>
      <field>
        <column_name>status</column_name>
        <stream_name>status</stream_name>
      </field>
      <field>
        <column_name>recent_stranded_date</column_name>
        <stream_name>recent_stranded_date</stream_name>
      </field>
      <field>
        <column_name>first_call_datetime</column_name>
        <stream_name>first_call_datetime</stream_name>
      </field>
      <field>
        <column_name>first_meeting_datetime</column_name>
        <stream_name>first_meeting_datetime</stream_name>
      </field>
      <field>
        <column_name>last_call_datetime</column_name>
        <stream_name>last_call_datetime</stream_name>
      </field>
      <field>
        <column_name>last_meeting_datetime</column_name>
        <stream_name>last_meeting_datetime</stream_name>
      </field>
      <field>
        <column_name>next_call_datetime</column_name>
        <stream_name>next_call_datetime</stream_name>
      </field>
      <field>
        <column_name>next_meeting_datetime</column_name>
        <stream_name>next_meeting_datetime</stream_name>
      </field>
      <field>
        <column_name>next_contact_datetime</column_name>
        <stream_name>next_contact_datetime</stream_name>
      </field>
      <field>
        <column_name>total_call_count</column_name>
        <stream_name>total_call_count</stream_name>
      </field>
      <field>
        <column_name>total_meeting_count</column_name>
        <stream_name>total_meeting_count</stream_name>
      </field>
      <field>
        <column_name>final_contact_datetime</column_name>
        <stream_name>final_contact_datetime</stream_name>
      </field>
      <field>
        <column_name>info_deadline</column_name>
        <stream_name>info_deadline</stream_name>
      </field>
      <field>
        <column_name>manager_deadline</column_name>
        <stream_name>manager_deadline</stream_name>
      </field>
      <field>
        <column_name>change_manager_deadline</column_name>
        <stream_name>change_manager_deadline</stream_name>
      </field>
      <field>
        <column_name>dept_deadline</column_name>
        <stream_name>dept_deadline</stream_name>
      </field>
      <field>
        <column_name>lifecycle_deadline</column_name>
        <stream_name>lifecycle_deadline</stream_name>
      </field>
      <field>
        <column_name>accountinfo_completeness_sign</column_name>
        <stream_name>accountinfo_completeness_sign</stream_name>
      </field>
      <field>
        <column_name>opptinfo_completeness_sign</column_name>
        <stream_name>opptinfo_completeness_sign</stream_name>
      </field>
      <field>
        <column_name>number</column_name>
        <stream_name>number</stream_name>
      </field>
      <field>
        <column_name>property_prove</column_name>
        <stream_name>property_prove</stream_name>
      </field>
      <field>
        <column_name>stranded_user_id</column_name>
        <stream_name>stranded_user_id</stream_name>
      </field>
      <field>
        <column_name>initial_user_id</column_name>
        <stream_name>initial_user_id</stream_name>
      </field>
      <field>
        <column_name>initial_dept_id</column_name>
        <stream_name>initial_dept_id</stream_name>
      </field>
      <field>
        <column_name>change_times</column_name>
        <stream_name>change_times</stream_name>
      </field>
      <field>
        <column_name>main_number_field</column_name>
        <stream_name>main_number_field</stream_name>
      </field>
      <field>
        <column_name>unicode_id</column_name>
        <stream_name>unicode_id</stream_name>
      </field>
      <field>
        <column_name>is_private</column_name>
        <stream_name>is_private</stream_name>
      </field>
      <field>
        <column_name>cancel_sign</column_name>
        <stream_name>cancel_sign</stream_name>
      </field>
      <field>
        <column_name>date_created</column_name>
        <stream_name>date_created</stream_name>
      </field>
      <field>
        <column_name>activation_count</column_name>
        <stream_name>activation_count</stream_name>
      </field>
      <field>
        <column_name>boss_sign</column_name>
        <stream_name>boss_sign</stream_name>
      </field>
      <field>
        <column_name>cti_last_callin_datetime</column_name>
        <stream_name>cti_last_callin_datetime</stream_name>
      </field>
      <field>
        <column_name>cti_last_callout_datetime</column_name>
        <stream_name>cti_last_callout_datetime</stream_name>
      </field>
      <field>
        <column_name>cti_contact_deadline</column_name>
        <stream_name>cti_contact_deadline</stream_name>
      </field>
      <field>
        <column_name>contact_policy</column_name>
        <stream_name>contact_policy</stream_name>
      </field>
      <field>
        <column_name>is_recovery</column_name>
        <stream_name>is_recovery</stream_name>
      </field>
      <field>
        <column_name>2013_3_sign</column_name>
        <stream_name>2013_3_sign</stream_name>
      </field>
      <field>
        <column_name>source_type</column_name>
        <stream_name>source_type</stream_name>
      </field>
      <field>
        <column_name>assigned_dept_id_bak</column_name>
        <stream_name>assigned_dept_id_bak</stream_name>
      </field>
      <field>
        <column_name>assigned_user_id_bak</column_name>
        <stream_name>assigned_user_id_bak</stream_name>
      </field>
      <field>
        <column_name>organize_id</column_name>
        <stream_name>organize_id</stream_name>
      </field>
      <field>
        <column_name>domainFrom</column_name>
        <stream_name>domainFrom</stream_name>
      </field>
      <field>
        <column_name>is_estate</column_name>
        <stream_name>is_estate</stream_name>
      </field>
      <field>
        <column_name>estate_num</column_name>
        <stream_name>estate_num</stream_name>
      </field>
      <field>
        <column_name>is_estate_project</column_name>
        <stream_name>is_estate_project</stream_name>
      </field>
      <field>
        <column_name>monthly_house_payments_date</column_name>
        <stream_name>monthly_house_payments_date</stream_name>
      </field>
      <field>
        <column_name>monthly_house_payments_amount</column_name>
        <stream_name>monthly_house_payments_amount</stream_name>
      </field>
      <field>
        <column_name>is_car</column_name>
        <stream_name>is_car</stream_name>
      </field>
      <field>
        <column_name>car_num</column_name>
        <stream_name>car_num</stream_name>
      </field>
      <field>
        <column_name>is_car_mortgage</column_name>
        <stream_name>is_car_mortgage</stream_name>
      </field>
      <field>
        <column_name>monthly_car_payments_date</column_name>
        <stream_name>monthly_car_payments_date</stream_name>
      </field>
      <field>
        <column_name>monthly_car_payments_amount</column_name>
        <stream_name>monthly_car_payments_amount</stream_name>
      </field>
      <field>
        <column_name>is_car_full</column_name>
        <stream_name>is_car_full</stream_name>
      </field>
      <field>
        <column_name>car_full_amaount</column_name>
        <stream_name>car_full_amaount</stream_name>
      </field>
      <field>
        <column_name>by_car_date</column_name>
        <stream_name>by_car_date</stream_name>
      </field>
      <field>
        <column_name>is_business_entity</column_name>
        <stream_name>is_business_entity</stream_name>
      </field>
      <field>
        <column_name>business_entity_water</column_name>
        <stream_name>business_entity_water</stream_name>
      </field>
      <field>
        <column_name>is_business_license</column_name>
        <stream_name>is_business_license</stream_name>
      </field>
      <field>
        <column_name>registration_date</column_name>
        <stream_name>registration_date</stream_name>
      </field>
      <field>
        <column_name>no_business_license_date</column_name>
        <stream_name>no_business_license_date</stream_name>
      </field>
      <field>
        <column_name>is_credit</column_name>
        <stream_name>is_credit</stream_name>
      </field>
      <field>
        <column_name>credit_total_amount</column_name>
        <stream_name>credit_total_amount</stream_name>
      </field>
      <field>
        <column_name>credit_use_amount</column_name>
        <stream_name>credit_use_amount</stream_name>
      </field>
      <field>
        <column_name>is_social_security</column_name>
        <stream_name>is_social_security</stream_name>
      </field>
      <field>
        <column_name>social_security_base</column_name>
        <stream_name>social_security_base</stream_name>
      </field>
      <field>
        <column_name>social_security_hand</column_name>
        <stream_name>social_security_hand</stream_name>
      </field>
      <field>
        <column_name>is_accumulation_fund</column_name>
        <stream_name>is_accumulation_fund</stream_name>
      </field>
      <field>
        <column_name>accumulation_fund_base</column_name>
        <stream_name>accumulation_fund_base</stream_name>
      </field>
      <field>
        <column_name>accumulation_fund_hand</column_name>
        <stream_name>accumulation_fund_hand</stream_name>
      </field>
      <field>
        <column_name>is_policy</column_name>
        <stream_name>is_policy</stream_name>
      </field>
      <field>
        <column_name>year_month_pay</column_name>
        <stream_name>year_month_pay</stream_name>
      </field>
      <field>
        <column_name>policy_type</column_name>
        <stream_name>policy_type</stream_name>
      </field>
      <field>
        <column_name>policy_date</column_name>
        <stream_name>policy_date</stream_name>
      </field>
      <field>
        <column_name>policy_amount</column_name>
        <stream_name>policy_amount</stream_name>
      </field>
      <field>
        <column_name>is_history_project</column_name>
        <stream_name>is_history_project</stream_name>
      </field>
      <field>
        <column_name>history_project</column_name>
        <stream_name>history_project</stream_name>
      </field>
      <field>
        <column_name>is_rejected_project</column_name>
        <stream_name>is_rejected_project</stream_name>
      </field>
      <field>
        <column_name>rejected_project_reason</column_name>
        <stream_name>rejected_project_reason</stream_name>
      </field>
      <field>
        <column_name>is_know_project_spouse</column_name>
        <stream_name>is_know_project_spouse</stream_name>
      </field>
      <field>
        <column_name>is_know_project_colleague</column_name>
        <stream_name>is_know_project_colleague</stream_name>
      </field>
      <field>
        <column_name>is_know_project_relative</column_name>
        <stream_name>is_know_project_relative</stream_name>
      </field>
      <field>
        <column_name>is_know_project_friend</column_name>
        <stream_name>is_know_project_friend</stream_name>
      </field>
      <field>
        <column_name>credit_total_overdue</column_name>
        <stream_name>credit_total_overdue</stream_name>
      </field>
      <field>
        <column_name>credit_continuous_overdue</column_name>
        <stream_name>credit_continuous_overdue</stream_name>
      </field>
      <field>
        <column_name>income_amount</column_name>
        <stream_name>income_amount</stream_name>
      </field>
      <field>
        <column_name>business_entity</column_name>
        <stream_name>business_entity</stream_name>
      </field>
      <field>
        <column_name>flowing</column_name>
        <stream_name>flowing</stream_name>
      </field>
      <field>
        <column_name>nation</column_name>
        <stream_name>nation</stream_name>
      </field>
      <field>
        <column_name>education</column_name>
        <stream_name>education</stream_name>
      </field>
      <field>
        <column_name>wedlock</column_name>
        <stream_name>wedlock</stream_name>
      </field>
      <field>
        <column_name>income_source</column_name>
        <stream_name>income_source</stream_name>
      </field>
      <field>
        <column_name>is_children</column_name>
        <stream_name>is_children</stream_name>
      </field>
      <field>
        <column_name>is_verify</column_name>
        <stream_name>is_verify</stream_name>
      </field>
      <field>
        <column_name>verify_user_id</column_name>
        <stream_name>verify_user_id</stream_name>
      </field>
      <field>
        <column_name>verify_date</column_name>
        <stream_name>verify_date</stream_name>
      </field>
      <field>
        <column_name>profession</column_name>
        <stream_name>profession</stream_name>
      </field>
      <field>
        <column_name>purchase_channel1_id</column_name>
        <stream_name>purchase_channel1_id</stream_name>
      </field>
      <field>
        <column_name>purchase_channel1_name</column_name>
        <stream_name>purchase_channel1_name</stream_name>
      </field>
      <field>
        <column_name>purchase_channel2_id</column_name>
        <stream_name>purchase_channel2_id</stream_name>
      </field>
      <field>
        <column_name>purchase_channel2_name</column_name>
        <stream_name>purchase_channel2_name</stream_name>
      </field>
      <field>
        <column_name>purchase_type</column_name>
        <stream_name>purchase_type</stream_name>
      </field>
      <field>
        <column_name>from_channels1_id</column_name>
        <stream_name>from_channels1_id</stream_name>
      </field>
      <field>
        <column_name>from_channels1_name</column_name>
        <stream_name>from_channels1_name</stream_name>
      </field>
      <field>
        <column_name>from_channels2_id</column_name>
        <stream_name>from_channels2_id</stream_name>
      </field>
      <field>
        <column_name>from_channels2_name</column_name>
        <stream_name>from_channels2_name</stream_name>
      </field>
      <field>
        <column_name>create_type</column_name>
        <stream_name>create_type</stream_name>
      </field>
      <field>
        <column_name>idcardno_address</column_name>
        <stream_name>idcardno_address</stream_name>
      </field>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>576</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>版本信息</name>
    <type>WriteToLog</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <loglevel>log_level_basic</loglevel>
    <displayHeader>Y</displayHeader>
    <limitRows>N</limitRows>
    <limitRowsNumber>0</limitRowsNumber>
    <logmessage>#***********************************************************************************
# MoerLong EDW ETL script -- Coding By Kettle
# 任 务 名: sta_crm_accounts_bj
# 目 标 表: sta_crm_accounts_bj  类型一sta层输出表
# 源 表 名: accounts   类型一sta层输入表           
# 加载策略: [03] (注,01:直接追加 02:增量拉链,03:全表拉链,04:全表覆盖,05:增量覆盖)
# 运行周期: [1] (注, 1:天,2:星期,3:旬,4:月,5:季,6:半年,7:年，00:其他)
# 脚本功能: 实现CRM系统accounts表的sta层处理
# 创建时间: 2018-01-25
# 作    者: huangzz
# 修改记录: 1、
#          
#***********************************************************************************
</logmessage>
    <fields>
      </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>144</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>获取变量</name>
    <type>GetVariable</type>
    <description />
    <distribute>N</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <field>
        <name>op_time</name>
        <variable>${op_time}</variable>
        <type>String</type>
        <format />
        <currency />
        <decimal />
        <group />
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>272</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
